### Goal
The primary goal of this ADS is to establish a comprehensive framework for detecting and alerting on threat events such as vulnerabilities, spyware, viruses, and wildfire incidents from Palo Alto Networks next-generation firewalls THREAT log events. This will ensure timely identification and response to security threats, minimizing potential impacts on organizational assets.

### Categorization
These attempts are categorized as:
- [Initial Access / Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190/)

### Strategy Abstract

The stragey will function as follows:
- Monitor all THREAT type signatures generated by Palo Alto Networks security profiles.
- Alert on any signature coming from the internal network.
- Alert on any signatures coming from the public network that was alerted (allowed).
- Identify and filter out any known vulnerability scanners or security testing software. 

### Technical Context



### Blind Spots and Assumptions

This strategy relies on the following assumptions:

- Security profiles are configured according to best practicesn by the vendor.
- SSL inspection is enabled on IPv4 policies to inspect traffic.
- SIEM is successfully indexing network IPS logs.

A blind spot will occur if any of the assumptions are violated. For instance, the following would trip the alert:

- Security profiles are not adequately configured
- SSL inspection is not enabled on IPv4 policies configured with security profiles.
- A legitimate threat signature is added as an exception in the firewall policy.
- SIEM is not successfully indexing network IPS logs.

### False Positives
There are several instances where false positives will occur:
- Vulnerability scanners
- Misconfigured systems.
- Legacy applications

### Validation

Validation can occur for this ADS by performing the following execution on any Windows host:

<code>curl -o eicar.com.txt https://www.eicar.org/download/eicar.com.txt </code>

### Priority

The priority is set to medium under all conditions.

### Detection Rules

The following detection rules are in scope for this alerting and detection strategy:
- Palo Alto Networks Multiple Threat Signatures from Public Network
- Palo Alto Networks Multiple Threat Signatures from Private Network
- Palo Alto Networks Vulnerability Signature from Private Network
- Palo Alto Networks Vulnerability Signature Allowed from Public
- Palo Alto Networks Antivirus Signature
- Palo Alto Networks Antispyware Signature
- Palo Alto Networks WildFire Signature
- Palo Alto Networks Zone Protection Signature

### Response

In the event that this alert fires, the following response procedures are recommended:

