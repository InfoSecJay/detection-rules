title: Potentially Suspicious Malware Callback Communication
id: 2a2cb124-8111-4fda-a82e-52172604dd3e
status: test
description: Detects programs that connect to known malware callback ports.
references:
    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
    - https://github.com/SigmaHQ/sigma/blob/f33530e7561d98bc6f898f5a9137c3b2a7159a1b/rules/windows/network_connection/net_connection_win_susp_malware_callback_port.yml
author: JayInfoSec
date: 2024-10-10
modified: 2024-10-10
tags:
    - attack.persistence
    - attack.command-and-control
    - attack.t1571
logsource:
    category: network
    service: firewall
detection:
    selection:
        DestinationPort:
            - '100'
            - '198'
            - '200'
            - '243'
            - '473'
            - '666'
            - '700'
            - '743'
            - '777'
            - '1443'
            - '1515'
            - '1777'
            - '1817'
            - '1904'
            - '1960'
            - '2443'
            - '2448'
            - '3360'
            - '3675'
            - '3939'
            - '4040'
            - '4433'
            - '4438'
            - '4443'
            - '4444'
            - '4455'
            - '5445'
            - '5552'
            - '5649'
            - '6625'
            - '7210'
            - '7777'
            - '8143'
            - '8843'
            - '9631'
            - '9943'
            - '10101'
            - '12102'
            - '12103'
            - '12322'
            - '13145'
            - '13394'
            - '13504'
            - '13505'
            - '13506'
            - '13507'
            - '14102'
            - '14103'
            - '14154'
            - '49180'
            - '65520'
            - '65535'
    filter_main_local_ranges:
        DestinationIp|cidr:
            - '127.0.0.0/8'
            - '10.0.0.0/8'
            - '172.16.0.0/12'
            - '192.168.0.0/16'
            - '169.254.0.0/16'
            - '::1/128'  # IPv6 loopback
            - 'fe80::/10'  # IPv6 link-local addresses
            - 'fc00::/7'  # IPv6 private addresses
    condition: selection and not 1 of filter_main_*
falsepositives:
    - Unknown
level: medium